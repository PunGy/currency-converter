import{f as m,a as y,b as ge,t as Ce,i as Ee,s as x,c as A,p as k,d as Se,e as ke,r as u,j as g,S as N,g as c,I as E,h as Le,k as Oe,l as be,m as Ae,n as He,C as Re,o as b,P as Be,T as we,q as Ie,A as Te,B as _,u as $e,G as f,v as C,w as h,x as v,y as Me,z as P,D as K,E as H,F as R,H as V,J as U,K as xe,L as Ne,M as _e,N as j,O as ve,Q as Pe,R as Ke,U as Ve}from"./vendor-7414bfa3.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();const F=e=>()=>ge(localStorage.getItem(e)),D=(e,t)=>Ce(()=>(localStorage.setItem(e,JSON.stringify(t)),t),Ee),W=e=>t=>(D(e,t)(),t),z=e=>m(F(e),y(()=>null,JSON.parse))(),Ue=(e,t)=>(D(t,e)(),e),G=e=>m(F(e),y(()=>[],JSON.parse))(),je=5;var S=(e=>(e.SELECT="SELECT",e.REMOVE="REMOVE",e.LOCK="LOCK",e.UNLOCK="UNLOCK",e.SWAP="SWAP",e))(S||{});const I=e=>e.reduce((t,n)=>("locked"in n?t[1].push(n):t[0].push(n),t),[[],[]]),T=ke("locked"),Fe={SELECT:(e,t)=>k(e,Se(n=>n.code===t.code),y(()=>{const[n,o]=I(e);n.unshift(t),o.forEach(s=>{n.splice(s.locked,0,s)});const r=n;return r.length>je?r.slice(0,-1):r},()=>e)),REMOVE:(e,t)=>{const[n,o]=I(e.filter((r,s)=>s!==t));return o.forEach(r=>{n.splice(r.locked,0,T(r))}),n},LOCK:(e,t)=>e.map((n,o)=>o===t?{...n,locked:o}:n),UNLOCK:(e,t)=>e.map((n,o)=>o===t?T(n):n),SWAP:(e,t)=>{const[n,o]=t;if(e[n]===void 0||e[o]===void 0||n===o)return e;const r=[...e],s=r[n];"locked"in s&&(s.locked=o);const a=r[o];return"locked"in a&&(a.locked=n),[r[n],r[o]]=[r[o],r[n]],r}},J=(e,t,n)=>n.type in e?e[n.type](t,n.payload):t,q=(e,t,n=[])=>e.pipe(x((o,r)=>Ue(J(Fe,o,r),t),n)),De={SELECT:(e,t)=>t,REMOVE:()=>null},Y=(e,t)=>e.pipe(x((n,o)=>J(De,n,o),t)).pipe(A(t)),X=e=>t=>e({type:"SELECT",payload:t}),We=u.forwardRef(({currency:e,dispatchAction:t,index:n,history:o,onClose:r},s)=>{const a=u.useCallback(()=>{t({type:S.REMOVE,payload:n}),r()},[n,t]),l=u.useCallback((p,i)=>{p<0||i<0||p>=o.length||i>=o.length||t({type:S.SWAP,payload:[p,i]})},[t,n,o]),d=u.useCallback(()=>{t({type:S.LOCK,payload:n}),r()},[n,t,r]);return g(N,{direction:"row",spacing:1,ref:s,children:[c(E,{color:"error",onClick:a,children:c(Le,{})}),c(E,{onClick:()=>l(n,n-1),children:c(Oe,{})}),c(E,{onClick:()=>l(n,n+1),children:c(be,{})}),c(E,{onClick:d,children:"locked"in e?c(Ae,{}):c(He,{})})]})}),ze=u.memo(({isActive:e,currency:t,onSelect:n,onLongPress:o,isLocked:r})=>{const s=u.useRef(),a=u.useRef(),l=u.useRef(null);return c(Re,{ref:l,sx:{backgroundColor:d=>e?d.palette.primary.light:r?"#ff748e":b[100],border:d=>`1px solid ${e?d.palette.primary.dark:b[600]}`,"&:hover":{backgroundColor:d=>e?d.palette.primary.light:r?"#ff97ab":b[300]}},color:e?"primary":"default",label:t.code.toUpperCase(),onMouseDown:()=>{s.current=setTimeout(()=>{a.current=!0,o(t,l.current)},700)},onMouseUp:()=>{clearTimeout(s.current),a.current?a.current=!1:n(t)},clickable:!0})},(e,t)=>e.isActive===t.isActive&&e.currency.code===t.currency.code),Ge=({list:e,align:t,active:n,dispatchAction:o})=>{const[r,s]=u.useState(null),[a,l]=u.useState(null),d=u.useCallback((i,O)=>{l(i),s(O)},[]),p=u.useCallback(()=>{l(null),s(null)},[]);return g(N,{direction:"row",spacing:1,children:[c(Be,{open:a!==null,anchorEl:r,onClose:p,elevation:0,anchorOrigin:{vertical:t,horizontal:"center"},transformOrigin:{vertical:t==="top"?"bottom":"top",horizontal:"center"},children:a&&c(We,{dispatchAction:o,currency:a,index:e.findIndex(i=>i.code===a.code),history:e,onClose:p})}),e.map(i=>k([n!==null&&n.code===i.code,"locked"in i],([O,ye])=>c(ze,{isActive:O,isLocked:ye,currency:i,onSelect:X(o),onLongPress:d},i.code)))]})},L=({onValueChange:e,...t})=>c(we,{InputLabelProps:{shrink:!0},onChange:n=>e&&e(n.target.value),sx:{width:"100%",...t==null?void 0:t.sx},...t}),Je=$e({ignoreCase:!0,stringify:e=>e.code+e.title}),qe=({value:e,currencies:t,select:n})=>c(Te,{value:e,options:t,filterOptions:Je,isOptionEqualToValue:(o,r)=>o.code===r.code,getOptionLabel:({code:o})=>o?o.toUpperCase():"",onChange:(o,r)=>r&&n(r),autoHighlight:!0,renderOption:(o,r)=>g(_,{component:"li",...o,children:["(",r.code.toUpperCase(),") ",r.title]}),renderInput:o=>c(L,{...o,label:"Select currency",inputProps:{...o.inputProps,autoComplete:"new-password"}})}),Ye=({currencies:e,value:t,select:n})=>k(e,y(()=>c(L,{disabled:!0,value:"loading currencies..."}),o=>k(o,Ie(()=>c(L,{disabled:!0,value:"Unable to load currencies"}),r=>c(qe,{select:n,currencies:r,value:t}))))),Xe=e=>e===""?e:Number(e),$=({currenciesToSelect:e,activeCurrency:t,value:n,setValue:o,history:r,align:s,dispatchAction:a})=>g(f,{container:!0,direction:s==="bottom"?"column-reverse":"column",spacing:2,children:[c(f,{item:!0,children:c(Ge,{align:s,active:t,dispatchAction:a,list:r})}),c(f,{item:!0,children:c(Ye,{currencies:e,select:X(a),value:t})}),c(f,{item:!0,children:c(L,{disabled:t==null,onValueChange:m(Xe,o),type:"number",value:n})})]}),Q="latest",Z=(e,t)=>`https://cdn.jsdelivr.net/gh/fawazahmed0/currency-api@1/${e}/${t}`,[ee,Ct]=C(),Qe=e=>Object.entries(e).map(([t,n])=>({code:t,title:n})),te=()=>async e=>e.ok?e.json():e.text().then(t=>Promise.reject(t)),ne=e=>xe(R(Ne({error:!0,message:e.message}))),[Ze]=h(ee.pipe(A(Q),v(e=>P(Z(e,"currencies.min.json")).pipe(K(te()),H(m(Qe,V,R)),U(ne)))),Me),et=e=>({date:e.date,currency:"usd",rate:e.usd}),[Et,tt]=h(ee.pipe(A(Q),v(e=>P(Z(e,"currencies/usd.min.json")).pipe(K(te()),H(m(et,V,R)),U(ne))))),nt=()=>c(_,{sx:{padding:2,display:"flex",justifyContent:"center"},children:c(_e,{color:"action",fontSize:"large"})}),[re,rt]=C(),[oe,ot]=C(),ce="LATEST_A",se="LATEST_B",ae=z(ce),le=z(se),B=Y(re,ae),w=Y(oe,le),[ct]=h(B.pipe(j(W(ce))),ae),[st]=h(w.pipe(j(W(se))),le),ie="HISTORY_A",ue="HISTORY_B",de=G(ie),pe=G(ue),at=q(re,ie,de),lt=q(oe,ue,pe),[it]=h(at,de),[ut]=h(lt,pe),[dt,fe]=C(),[pt,he]=C(),ft=y(()=>null,ve(()=>null)),me=(e,t,n,o)=>Pe([e,t,n,tt]).pipe(H(([[r,s],a,l,d])=>{if(s){const p=ft(d);if(r!==""){if(p&&a&&l){const i=r/p.rate[a.code]*p.rate[l.code];o([Number(i.toFixed(2)),!1])}}else o(["",!1])}return r})),[ht]=h(me(dt,B,w,he),""),[mt]=h(me(pt,w,B,fe),""),M=e=>t=>{e([t,!0])},yt=()=>{const e=Ze(),t=ht(),n=mt(),o=it(),r=ut(),s=ct(),a=st(),l=M(fe),d=M(he);return u.useEffect(()=>{s&&l(1)},[]),c(Ke,{maxWidth:"sm",sx:{height:"100%",display:"flex",alignItems:"center"},children:g(f,{container:!0,direction:"column",children:[c(f,{item:!0,children:c($,{align:"top",value:t,currenciesToSelect:e,history:o,activeCurrency:s,dispatchAction:rt,setValue:l})}),c(f,{item:!0,children:c(nt,{})}),c(f,{item:!0,children:c($,{align:"bottom",value:n,currenciesToSelect:e,history:r,activeCurrency:a,dispatchAction:ot,setValue:d})})]})})};Ve(document.getElementById("root")).render(c(u.StrictMode,{children:c(yt,{})}));
